(function(F,C,x,D){var H,s,w=F.mobiscroll,J=w.util,u=J.jsPrefix,z=J.has3d,I=J.getCoord,v=J.constrain,y=J.isString,E=/android [1-3]/i.test(navigator.userAgent),A=/(iphone|ipod|ipad).* os 8_/i.test(navigator.userAgent),t="webkitAnimationEnd animationend",B=function(){},G=function(a){a.preventDefault()};w.classes.Frame=function(ar,ap,aq){var p,aw,av,b,g,ah,ax,aB,at,q,m,d,aj,am,f,r,n,k,an,c,ao,ay,al,aA,h=this,i=F(ar),ai=[],l={};function ak(K){if(m){m.removeClass("dwb-a")}m=F(this);if(!m.hasClass("dwb-d")&&!m.hasClass("dwb-nhl")){m.addClass("dwb-a")}if(K.type==="mousedown"){F(x).on("mouseup",ag)}}function ag(K){if(m){m.removeClass("dwb-a");m=null}if(K.type==="mouseup"){F(x).off("mouseup",ag)}}function a(K){if(K.keyCode==13){h.select()}else{if(K.keyCode==27){h.cancel()}}}function e(K){if(!K){ax.focus()}h.ariaMessage(c.ariaMessage)}function au(M){var O,K,L,N=c.focusOnClose;h._markupRemove();b.remove();if(H&&!M){setTimeout(function(){if(N===D||N===true){s=true;O=H[0];L=O.type;K=O.value;try{O.type="button"}catch(P){}H.focus();O.type=L;O.value=K}else{if(N){F(N).focus()}}},200)}h._isVisible=false;aj("onHide",[])}function az(K){clearTimeout(l[K.type]);l[K.type]=setTimeout(function(){var L=K.type=="scroll";if(L&&!ao){return}h.position(!L)},200)}function o(K){if(K.target.nodeType&&!ax[0].contains(K.target)){ax.focus()}}function j(K,L){if(K){K()}if(F(x.activeElement).is("input,textarea")){F(x.activeElement).blur()}H=L;h.show();setTimeout(function(){s=false},300)}w.classes.Base.call(this,ar,ap,true);h.position=function(S){var Z,L,V,ab,X,W,O,Q,K,af,Y,R,U,ae,T,M,N=0,ac=0,aa={},P="100%",ad=aB[0].innerHeight||aB.innerHeight();if((al===P&&aA===ad&&S)||an){return}if(h._isFullScreen||/top|bottom/.test(c.display)){ax.width(P)}if(aj("onPosition",[b,P,ad])===false||!f){return}T=aB.scrollLeft();M=aB.scrollTop();ab=c.anchor===D?i:F(c.anchor);if(h._isLiquid&&c.layout!=="liquid"){if(P<400){b.addClass("dw-liq")}else{b.removeClass("dw-liq")}}if(!h._isFullScreen&&/modal|bubble/.test(c.display)){at.width("");F(".mbsc-w-p",b).each(function(){Z=F(this).outerWidth(true);N+=Z;ac=(Z>ac)?Z:ac});Z=N>P?ac:N;at.width(Z+1).css("white-space",N>P?"":"nowrap")}r=ax.outerWidth();n=ax.outerHeight(true);ao=n<=ad&&r<=P;h.scrollLock=ao;if(c.display=="modal"){L=Math.max(0,T+(P-r)/2);V=M+(ad-n)/2}else{if(c.display=="bubble"){ae=true;af=F(".dw-arrw-i",b);O=ab.offset();Q=Math.abs(aw.offset().top-O.top);K=Math.abs(aw.offset().left-O.left);X=ab.outerWidth();W=ab.outerHeight();L=v(K-(ax.outerWidth(true)-X)/2,T+3,T+P-r-3);V=Q-n;if((V<M)||(Q>M+ad)){ax.removeClass("dw-bubble-top").addClass("dw-bubble-bottom");V=Q+W}else{ax.removeClass("dw-bubble-bottom").addClass("dw-bubble-top")}Y=af.outerWidth();R=v(K+X/2-(L+(r-Y)/2),0,Y);F(".dw-arr",b).css({left:R})}else{L=T;if(c.display=="top"){V=M}else{if(c.display=="bottom"){V=M+ad-n}}}}V=V<0?0:V;aa.top=V;aa.left=L;ax.css(aa);ah.height(0);U=Math.max(V+n,c.context=="body"?F(x).height():aw[0].scrollHeight);ah.css({height:U});if(ae&&((V+n>M+ad)||(Q>M+ad))){an=true;setTimeout(function(){an=false},300);aB.scrollTop(Math.min(V+n-ad,U-ad))}al=P;aA=ad};h.attachShow=function(L,K){ai.push({readOnly:L.prop("readonly"),el:L});if(c.display!=="inline"){if(ay&&L.is("input")){L.prop("readonly",true).on("mousedown.dw",function(M){M.preventDefault()})}if(c.showOnFocus){L.on("focus.dw",function(){if(!s){j(K,L)}})}if(c.showOnTap){L.on("keydown.dw",function(M){if(M.keyCode==32||M.keyCode==13){M.preventDefault();M.stopPropagation();j(K,L)}});h.tap(L,function(){j(K,L)})}}};h.select=function(){if(!f||h.hide(false,"set")!==false){h._fillValue();aj("onSelect",[h._value])}};h.cancel=function(){if(!f||h.hide(false,"cancel")!==false){aj("onCancel",[h._value])}};h.clear=function(){aj("onClear",[b]);if(f&&!h.live){h.hide(false,"clear")}h.setVal(null,true)};h.enable=function(){c.disabled=false;if(h._isInput){i.prop("disabled",false)}};h.disable=function(){c.disabled=true;if(h._isInput){i.prop("disabled",true)}};h.show=function(L,M){var K;if(c.disabled||h._isVisible){return}h._readValue();aj("onBeforeShow",[]);d=E?false:c.animate;if(d!==false){if(c.display=="top"){d="slidedown"}if(c.display=="bottom"){d="slideup"}}K='<div lang="'+c.lang+'" class="mbsc-'+c.theme+(c.baseTheme?" mbsc-"+c.baseTheme:"")+" dw-"+c.display+" "+(c.cssClass||"")+(h._isLiquid?" dw-liq":"")+(E?" mbsc-old":"")+(am?"":" dw-nobtn")+'"><div class="dw-persp">'+(f?'<div class="dwo"></div>':"")+"<div"+(f?' role="dialog" tabindex="-1"':"")+' class="dw'+(c.rtl?" dw-rtl":" dw-ltr")+'">'+(c.display==="bubble"?'<div class="dw-arrw"><div class="dw-arrw-i"><div class="dw-arr"></div></div></div>':"")+'<div class="dwwr"><div aria-live="assertive" class="dw-aria dw-hidden"></div>'+(c.headerText?'<div class="dwv">'+(y(c.headerText)?c.headerText:"")+"</div>":"");if(am){K+='<div class="dwbc">';F.each(q,function(O,N){N=y(N)?h.buttons[N]:N;if(N.handler==="set"){N.parentClass="dwb-s"}if(N.handler==="cancel"){N.parentClass="dwb-c"}N.handler=y(N.handler)?h.handlers[N.handler]:N.handler;K+="<div"+(c.btnWidth?' style="width:'+(100/q.length)+'%"':"")+' class="dwbw '+(N.parentClass||"")+'"><div tabindex="0" role="button" class="dwb'+O+" dwb-e "+(N.cssClass===D?c.btnClass:N.cssClass)+(N.icon?" mbsc-ic mbsc-ic-"+N.icon:"")+'">'+(N.text||"")+"</div></div>"});K+="</div>"}K+='<div class="dwcc">';K+=h._generateContent();K+="</div></div></div></div></div>";b=F(K);ah=F(".dw-persp",b);g=F(".dwo",b);at=F(".dwwr",b);av=F(".dwv",b);ax=F(".dw",b);p=F(".dw-aria",b);h._markup=b;h._header=av;h._isVisible=true;k="orientationchange resize";h._markupReady(b);aj("onMarkupReady",[b]);if(f){F(C).on("keydown",a);if(c.scrollLock){b.on("touchmove mousewheel wheel",function(N){if(ao){N.preventDefault()}})}if(u!=="Moz"){F("input,select,button",aw).each(function(){if(!this.disabled){F(this).addClass("dwtd").prop("disabled",true)}})}if(w.activeInstance){w.activeInstance.hide()}k+=" scroll";w.activeInstance=h;b.appendTo(aw);aB.on("focusin",o);if(z&&d&&!L){b.addClass("dw-in dw-trans").on(t,function(){b.off(t).removeClass("dw-in dw-trans").find(".dw").removeClass("dw-"+d);e(M)}).find(".dw").addClass("dw-"+d)}}else{if(i.is("div")&&!h._hasContent){i.html(b)}else{b.insertAfter(i)}}h._markupInserted(b);aj("onMarkupInserted",[b]);h.position();aB.on(k,az);b.on("selectstart mousedown",G).on("click",".dwb-e",G).on("keydown",".dwb-e",function(N){if(N.keyCode==32){N.preventDefault();N.stopPropagation();F(this).click()}}).on("keydown",function(P){if(P.keyCode==32){P.preventDefault()}else{if(P.keyCode==9&&f){var Q=b.find('[tabindex="0"]').filter(function(){return this.offsetWidth>0||this.offsetHeight>0}),N=Q.index(F(":focus",b)),R=Q.length-1,O=0;if(P.shiftKey){R=0;O=-1}if(N===R){Q.eq(O).focus();P.preventDefault()}}}});F("input,select,textarea",b).on("selectstart mousedown",function(N){N.stopPropagation()}).on("keydown",function(N){if(N.keyCode==32){N.stopPropagation()}});F.each(q,function(O,N){h.tap(F(".dwb"+O,b),function(P){N=y(N)?h.buttons[N]:N;N.handler.call(this,P,h)},true)});if(c.closeOnOverlay){h.tap(g,function(){h.cancel()})}if(f&&!d){e(M)}b.on("touchstart mousedown",".dwb-e",ak).on("touchend",".dwb-e",ag);h._attachEvents(b);aj("onShow",[b,h._tempValue])};h.hide=function(M,L,K){if(!h._isVisible||(!K&&!h._isValid&&L=="set")||(!K&&aj("onClose",[h._tempValue,L])===false)){return false}if(b){if(u!=="Moz"){F(".dwtd",aw).each(function(){F(this).prop("disabled",false).removeClass("dwtd")})}if(z&&f&&d&&!M&&!b.hasClass("dw-trans")){b.addClass("dw-out dw-trans").find(".dw").addClass("dw-"+d).on(t,function(){au(M)})}else{au(M)}aB.off(k,az).off("focusin",o)}if(f){F(C).off("keydown",a);delete w.activeInstance}};h.ariaMessage=function(K){p.html("");setTimeout(function(){p.html(K)},100)};h.isVisible=function(){return h._isVisible};h.setVal=B;h._generateContent=B;h._attachEvents=B;h._readValue=B;h._fillValue=B;h._markupReady=B;h._markupInserted=B;h._markupRemove=B;h._processSettings=B;h._presetLoad=function(K){K.buttons=K.buttons||(K.display!=="inline"?["set","cancel"]:[]);K.headerText=K.headerText===D?(K.display!=="inline"?"{value}":false):K.headerText};h.tap=function(O,P,L){var M,N,K;if(c.tap){O.on("touchstart.dw",function(Q){if(L){Q.preventDefault()}M=I(Q,"X");N=I(Q,"Y");K=false}).on("touchmove.dw",function(Q){if(!K&&Math.abs(I(Q,"X")-M)>20||Math.abs(I(Q,"Y")-N)>20){K=true}}).on("touchend.dw",function(Q){var R=this;if(!K){Q.preventDefault();P.call(R,Q)}w.tapped++;setTimeout(function(){w.tapped--},500)})}O.on("click.dw",function(Q){Q.preventDefault();P.call(this,Q)})};h.destroy=function(){h.hide(true,false,true);F.each(ai,function(K,L){L.el.off(".dw").prop("readonly",L.readOnly)});h._destroy()};h.init=function(K){h._init(K);h._isLiquid=(c.layout||(/top|bottom/.test(c.display)?"liquid":""))==="liquid";h._processSettings();i.off(".dw");q=c.buttons||[];f=c.display!=="inline";ay=c.showOnFocus||c.showOnTap;aB=F(c.context=="body"?C:c.context);aw=F(c.context);h.context=aB;h.live=true;F.each(q,function(L,M){if(M=="ok"||M=="set"||M.handler=="set"){h.live=false;return false}});h.buttons.set={text:c.setText,handler:"set"};h.buttons.cancel={text:(h.live)?c.closeText:c.cancelText,handler:"cancel"};h.buttons.clear={text:c.clearText,handler:"clear"};h._isInput=i.is("input");am=q.length>0;if(h._isVisible){h.hide(true,false,true)}aj("onInit",[]);if(f){h._readValue();if(!h._hasContent){h.attachShow(i)}}else{h.show()}i.on("change.dw",function(){if(!h._preventChange){h.setVal(i.val(),true,false)}h._preventChange=false})};h.buttons={};h.handlers={set:h.select,cancel:h.cancel,clear:h.clear};h._value=null;h._isValid=true;h._isVisible=false;c=h.settings;aj=h.trigger;if(!aq){h.init(ap)}};w.classes.Frame.prototype._defaults={lang:"en",setText:"Set",selectedText:"Selected",closeText:"Close",cancelText:"Cancel",clearText:"Clear",disabled:false,closeOnOverlay:true,showOnFocus:false,showOnTap:true,display:"modal",scrollLock:true,tap:true,btnClass:"dwb",btnWidth:true,focusOnClose:!A};w.themes.frame.mobiscroll={rows:5,showLabel:false,headerText:false,btnWidth:false,selectedLineHeight:true,selectedLineBorder:1,dateOrder:"MMddyy",weekDays:"min",checkIcon:"ion-ios7-checkmark-empty",btnPlusClass:"mbsc-ic mbsc-ic-arrow-down5",btnMinusClass:"mbsc-ic mbsc-ic-arrow-up5",btnCalPrevClass:"mbsc-ic mbsc-ic-arrow-left5",btnCalNextClass:"mbsc-ic mbsc-ic-arrow-right5"};F(C).on("focus",function(){if(H){s=true}})})(jQuery,window,document);