(function(a,c){a.each(["date","time","datetime"],function(i,h){a.mobiscroll.presetShort(h)});a.mobiscroll.i18n.zh={setText:"确定",cancelText:"取消",clearText:"明确",selectedText:"选",dateFormat:"yy-mm-dd",dateOrder:"yymmdd",dayNames:["周日","周一","周二","周三","周四","周五","周六"],dayNamesShort:["日","一","二","三","四","五","六"],dayNamesMin:["日","一","二","三","四","五","六"],dayText:"日",hourText:"时",minuteText:"分",monthNames:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],monthNamesShort:["一","二","三","四","五","六","七","八","九","十","十一","十二"],monthText:"月",secText:"秒",timeFormat:"HH:ii:ss",timeWheels:"HHii",yearText:"年",nowText:"当前",pmText:"下午",amText:"上午",dateText:"日",timeText:"时间",calendarText:"日历",closeText:"关闭",fromText:"开始时间",toText:"结束时间",wholeText:"合计",fractionText:"分数",unitText:"单位",labels:["年","月","日","小时","分钟","秒",""],labelsShort:["年","月","日","点","分","秒",""],startText:"开始",stopText:"停止",resetText:"重置",lapText:"圈",hideText:"隐藏",backText:"背部",undoText:"复原",offText:"关闭",onText:"开启"};var f=a.mobiscroll,d=f.datetime,e=new Date(),b={startYear:e.getFullYear()-10,endYear:e.getFullYear()+10,separator:" ",dateFormat:"mm-dd-yy",dateOrder:"mmddy",timeWheels:"hhiiA",timeFormat:"hh:ii A",dayText:"Day",monthText:"Month",yearText:"Year",hourText:"Hours",minuteText:"Minutes",ampmText:"&nbsp;",secText:"Seconds",nowText:"Now"},g=function(ar){var al=a(this),T={},q;if(al.is("input")){switch(al.attr("type")){case"date":q="yy-mm-dd";break;case"datetime":q="yy-mm-ddTHH:ii:ssZ";break;case"datetime-local":q="yy-mm-ddTHH:ii:ss";break;case"month":q="yy-mm";T.dateOrder="mmyy";break;case"time":q="HH:ii:ss";break}var Z=al.attr("min"),v=al.attr("max");if(Z){T.minDate=d.parseDate(q,Z)}if(v){T.maxDate=d.parseDate(q,v)}}var ao,an,ag,O,j,t,ap,w,at,F,H=a.extend({},ar.settings),ah=a.extend(ar.settings,f.datetime.defaults,b,T,H),k=0,V=[],U=[],n=[],ak={},S={},aq={y:ad,m:I,d:u,h:ac,i:L,s:aB,u:av,a:N},P=ah.invalid,az=ah.valid,aj=ah.preset,au=ah.dateOrder,r=ah.timeWheels,Y=au.match(/D/),aD=r.match(/a/i),K=r.match(/h/),D=aj=="datetime"?ah.dateFormat+ah.separator+ah.timeFormat:aj=="time"?ah.timeFormat:ah.dateFormat,aE=new Date(),ai=ah.steps||{},E=ai.hour||ah.stepHour||1,A=ai.minute||ah.stepMinute||1,y=ai.second||ah.stepSecond||1,aA=ai.zeroBased,m=ah.minDate||new Date(ah.startYear,0,1),R=ah.maxDate||new Date(ah.endYear,11,31,23,59,59),ax=aA?0:m.getHours()%E,Q=aA?0:m.getMinutes()%A,z=aA?0:m.getSeconds()%y,X=B(E,ax,(K?11:23)),aC=B(A,Q,59),ay=B(A,Q,59);q=q||D;if(aj.match(/date/i)){a.each(["y","m","d"],function(p,o){ao=au.search(new RegExp(o,"i"));if(ao>-1){n.push({o:ao,v:o})}});n.sort(function(p,o){return p.o>o.o?1:-1});a.each(n,function(o,p){ak[p.v]=o});j=[];for(an=0;an<3;an++){if(an==ak.y){k++;O=[];ag=[];t=ah.getYear(m);ap=ah.getYear(R);for(ao=t;ao<=ap;ao++){ag.push(ao);O.push((au.match(/yy/i)?ao:(ao+"").substr(2,2))+(ah.yearSuffix||""))}x(j,ag,O,ah.yearText)}else{if(an==ak.m){k++;O=[];ag=[];for(ao=0;ao<12;ao++){var aa=au.replace(/[dy]/gi,"").replace(/mm/,(ao<9?"0"+(ao+1):ao+1)+(ah.monthSuffix||"")).replace(/m/,ao+1+(ah.monthSuffix||""));ag.push(ao);O.push(aa.match(/MM/)?aa.replace(/MM/,'<span class="dw-mon">'+ah.monthNames[ao]+"</span>"):aa.replace(/M/,'<span class="dw-mon">'+ah.monthNamesShort[ao]+"</span>"))}x(j,ag,O,ah.monthText)}else{if(an==ak.d){k++;O=[];ag=[];for(ao=1;ao<32;ao++){ag.push(ao);O.push((au.match(/dd/i)&&ao<10?"0"+ao:ao)+(ah.daySuffix||""))}x(j,ag,O,ah.dayText)}}}}U.push(j)}if(aj.match(/time/i)){w=true;n=[];a.each(["h","i","s","a"],function(o,p){o=r.search(new RegExp(p,"i"));if(o>-1){n.push({o:o,v:p})}});n.sort(function(p,o){return p.o>o.o?1:-1});a.each(n,function(o,p){ak[p.v]=k+o});j=[];for(an=k;an<k+4;an++){if(an==ak.h){k++;O=[];ag=[];for(ao=ax;ao<(K?12:24);ao+=E){ag.push(ao);O.push(K&&ao===0?12:r.match(/hh/i)&&ao<10?"0"+ao:ao)}x(j,ag,O,ah.hourText)}else{if(an==ak.i){k++;O=[];ag=[];for(ao=Q;ao<60;ao+=A){ag.push(ao);O.push(r.match(/ii/)&&ao<10?"0"+ao:ao)}x(j,ag,O,ah.minuteText)}else{if(an==ak.s){k++;O=[];ag=[];for(ao=z;ao<60;ao+=y){ag.push(ao);O.push(r.match(/ss/)&&ao<10?"0"+ao:ao)}x(j,ag,O,ah.secText)}else{if(an==ak.a){k++;var h=r.match(/A/);x(j,[0,1],h?[ah.amText.toUpperCase(),ah.pmText.toUpperCase()]:[ah.amText,ah.pmText],ah.ampmText)}}}}}U.push(j)}function J(p,s,o){if(ak[s]!==c){return +p[ak[s]]}if(S[s]!==c){return S[s]}if(o!==c){return o}return aq[s](aE)}function x(p,o,aF,s){p.push({values:aF,keys:o,label:s})}function af(aF,o,p,s){return Math.min(s,Math.floor(aF/o)*o+p)}function ad(o){return ah.getYear(o)}function I(o){return ah.getMonth(o)}function u(o){return ah.getDay(o)}function ac(p){var o=p.getHours();o=K&&o>=12?o-12:o;return af(o,E,ax,X)}function L(o){return af(o.getMinutes(),A,Q,aC)}function aB(o){return af(o.getSeconds(),y,z,ay)}function av(o){return o.getMilliseconds()}function N(o){return aD&&o.getHours()>11?1:0}function W(s){if(s===null){return s}var o=J(s,"y"),p=J(s,"m"),aG=Math.min(J(s,"d",1),ah.getMaxDayOfMonth(o,p)),aF=J(s,"h",0);return ah.getDate(o,p,aG,J(s,"a",0)?aF+12:aF,J(s,"i",0),J(s,"s",0),J(s,"u",0))}function B(o,s,p){return Math.floor((p-s)/o)*o+s}function G(aJ,o){var s,aF,aH=false,aI=false,aG=0,p=0;m=W(ab(m));R=W(ab(R));if(C(aJ)){return aJ}if(aJ<m){aJ=m}if(aJ>R){aJ=R}s=aJ;aF=aJ;if(o!==2){aH=C(s);while(!aH&&s<R){s=new Date(s.getTime()+1000*60*60*24);aH=C(s);aG++}}if(o!==1){aI=C(aF);while(!aI&&aF>m){aF=new Date(aF.getTime()-1000*60*60*24);aI=C(aF);p++}}if(o===1&&aH){return s}if(o===2&&aI){return aF}return p<=aG&&aI?aF:s}function C(o){if(o<m){return false}if(o>R){return false}if(am(o,az)){return true}if(am(o,P)){return false}return true}function am(s,p){var o,aG,aF;if(p){for(aG=0;aG<p.length;aG++){o=p[aG];aF=o+"";if(!o.start){if(o.getTime){if(s.getFullYear()==o.getFullYear()&&s.getMonth()==o.getMonth()&&s.getDate()==o.getDate()){return true}}else{if(!aF.match(/w/i)){aF=aF.split("/");if(aF[1]){if((aF[0]-1)==s.getMonth()&&aF[1]==s.getDate()){return true}}else{if(aF[0]==s.getDate()){return true}}}else{aF=+aF.replace("w","");if(aF==s.getDay()){return true}}}}}}return false}function l(s,p,aI,aK,aJ,aF,aH){var aL,o,aG;if(s){for(aL=0;aL<s.length;aL++){o=s[aL];aG=o+"";if(!o.start){if(o.getTime){if(ah.getYear(o)==p&&ah.getMonth(o)==aI){aF[ah.getDay(o)-1]=aH}}else{if(!aG.match(/w/i)){aG=aG.split("/");if(aG[1]){if(aG[0]-1==aI){aF[aG[1]-1]=aH}}else{aF[aG[0]-1]=aH}}else{aG=+aG.replace("w","");for(an=aG-aK;an<aJ;an+=7){if(an>=0){aF[an]=aH}}}}}}}}function aw(aK,a0,aW,aF,aR,aO,aG,aJ,a3){var aH,aS,a6,s,p,a1,aY,aN,aL,aU,aQ,a5,aZ,aI,aM,o,a4,aX,aP={},a2={h:E,i:A,s:y,a:1},aV=ah.getDate(aR,aO,aG),aT=["a","h","i","s"];if(aK){a.each(aK,function(a8,a7){if(a7.start){a7.apply=false;aH=a7.d;aS=aH+"";a6=aS.split("/");if(aH&&((aH.getTime&&aR==ah.getYear(aH)&&aO==ah.getMonth(aH)&&aG==ah.getDay(aH))||(!aS.match(/w/i)&&((a6[1]&&aG==a6[1]&&aO==a6[0]-1)||(!a6[1]&&aG==a6[0])))||(aS.match(/w/i)&&aV.getDay()==+aS.replace("w","")))){a7.apply=true;aP[aV]=true}}});a.each(aK,function(a7,a8){aZ=0;aI=0;aQ=0;a5=c;a1=true;aY=true;aM=false;if(a8.start&&(a8.apply||(!a8.d&&!aP[aV]))){s=a8.start.split(":");p=a8.end.split(":");for(aU=0;aU<3;aU++){if(s[aU]===c){s[aU]=0}if(p[aU]===c){p[aU]=59}s[aU]=+s[aU];p[aU]=+p[aU]}s.unshift(s[0]>11?1:0);p.unshift(p[0]>11?1:0);if(K){if(s[1]>=12){s[1]=s[1]-12}if(p[1]>=12){p[1]=p[1]-12}}for(aU=0;aU<a0;aU++){if(V[aU]!==c){aN=af(s[aU],a2[aT[aU]],at[aT[aU]],F[aT[aU]]);aL=af(p[aU],a2[aT[aU]],at[aT[aU]],F[aT[aU]]);o=0;a4=0;aX=0;if(K&&aU==1){o=s[0]?12:0;a4=p[0]?12:0;aX=V[0]?12:0}if(!a1){aN=0}if(!aY){aL=F[aT[aU]]}if((a1||aY)&&(aN+o<V[aU]+aX&&V[aU]+aX<aL+a4)){aM=true}if(V[aU]!=aN){a1=false}if(V[aU]!=aL){aY=false}}}if(!a3){for(aU=a0+1;aU<4;aU++){if(s[aU]>0){aZ=a2[aW]}if(p[aU]<F[aT[aU]]){aI=a2[aW]}}}if(!aM){aN=af(s[a0],a2[aW],at[aW],F[aW])+aZ;aL=af(p[a0],a2[aW],at[aW],F[aW])-aI;if(a1){aQ=M(aJ,aN,F[aW],0)}if(aY){a5=M(aJ,aL,F[aW],1)}}if(a1||aY||aM){if(a3){a(".dw-li",aJ).slice(aQ,a5).addClass("dw-v")}else{a(".dw-li",aJ).slice(aQ,a5).removeClass("dw-v")}}}})}}function i(p,o){return a(".dw-li",p).index(a('.dw-li[data-val="'+o+'"]',p))}function M(o,aF,s,p){if(aF<0){return 0}if(aF>s){return a(".dw-li",o).length}return i(o,aF)+p}function ab(s,o){var p=[];if(s===null||s===c){return s}a.each(["y","m","d","a","h","i","s","u"],function(aF,aG){if(ak[aG]!==c){p[ak[aG]]=aq[aG](s)}if(o){S[aG]=aq[aG](s)}});return p}function ae(aF){var s,o,aG,p=[];if(aF){for(s=0;s<aF.length;s++){o=aF[s];if(o.start&&o.start.getTime){aG=new Date(o.start);while(aG<=o.end){p.push(new Date(aG.getFullYear(),aG.getMonth(),aG.getDate()));aG.setDate(aG.getDate()+1)}}else{p.push(o)}}return p}return aF}ar.getVal=function(o){return ar._hasValue||o?W(ar.getArrayVal(o)):null};ar.setDate=function(p,o,aG,aF,s){ar.setArrayVal(ab(p),o,s,aF,aG)};ar.getDate=ar.getVal;ar.format=D;ar.order=ak;ar.handlers.now=function(){ar.setDate(new Date(),false,0.3,true,true)};ar.buttons.now={text:ah.nowText,handler:"now"};P=ae(P);az=ae(az);at={y:m.getFullYear(),m:0,d:1,h:ax,i:Q,s:z,a:0};F={y:R.getFullYear(),m:11,d:31,h:X,i:aC,s:ay,a:1};return{wheels:U,headerText:ah.headerText?function(){return d.formatDate(D,W(ar.getArrayVal(true)),ah)}:false,formatValue:function(o){return d.formatDate(q,W(o),ah)},parseValue:function(o){if(!o){S={}}return ab(o?d.parseDate(q,o,ah):(ah.defaultValue||new Date()),!!o&&!!o.getTime)},validate:function(aI,o,aL,s){var aJ=G(W(ar.getArrayVal(true)),s),aH=ab(aJ),aF=J(aH,"y"),aK=J(aH,"m"),aG=true,p=true;a.each(["y","m","d","a","h","i","s"],function(aM,aU){if(ak[aU]!==c){var aT=at[aU],aW=F[aU],aS=31,aP=J(aH,aU),aO=a(".dw-ul",aI).eq(ak[aU]);if(aU=="d"){aS=ah.getMaxDayOfMonth(aF,aK);aW=aS;if(Y){a(".dw-li",aO).each(function(){var aX=a(this),a0=aX.data("val"),aY=ah.getDate(aF,aK,a0).getDay(),aZ=au.replace(/[my]/gi,"").replace(/dd/,(a0<10?"0"+a0:a0)+(ah.daySuffix||"")).replace(/d/,a0+(ah.daySuffix||""));a(".dw-i",aX).html(aZ.match(/DD/)?aZ.replace(/DD/,'<span class="dw-day">'+ah.dayNames[aY]+"</span>"):aZ.replace(/D/,'<span class="dw-day">'+ah.dayNamesShort[aY]+"</span>"))})}}if(aG&&m){aT=aq[aU](m)}if(p&&R){aW=aq[aU](R)}if(aU!="y"){var aR=i(aO,aT),aQ=i(aO,aW);a(".dw-li",aO).removeClass("dw-v").slice(aR,aQ+1).addClass("dw-v");if(aU=="d"){a(".dw-li",aO).removeClass("dw-h").slice(aS).addClass("dw-h")}}if(aP<aT){aP=aT}if(aP>aW){aP=aW}if(aG){aG=aP==aT}if(p){p=aP==aW}if(aU=="d"){var aV=ah.getDate(aF,aK,1).getDay(),aN={};l(P,aF,aK,aV,aS,aN,1);l(az,aF,aK,aV,aS,aN,0);a.each(aN,function(aY,aX){if(aX){a(".dw-li",aO).eq(aY).removeClass("dw-v")}})}}});if(w){a.each(["a","h","i","s"],function(aO,aM){var aQ=J(aH,aM),aP=J(aH,"d"),aN=a(".dw-ul",aI).eq(ak[aM]);if(ak[aM]!==c){aw(P,aO,aM,aH,aF,aK,aP,aN,0);aw(az,aO,aM,aH,aF,aK,aP,aN,1);V[aO]=+ar.getValidCell(aQ,aN,s).val}})}ar._tempWheelArray=aH}}};a.each(["date","time","datetime"],function(i,h){f.presets.scroller[h]=g})})(jQuery);